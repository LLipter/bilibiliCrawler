view.follow <- c(view, follow)
view.follow
zxview.follow <- data.frame(view=view, follow=follow, row.names=rawdata$title)
view.follow <- data.frame(view=view, follow=follow, row.names=rawdata$title)
view.follow
bangumi.viewfollow <- data.frame(view=unlist(rawdata["view"]), #
                                follow=unlist(rawdata["follow"]), #
                                row.names=rawdata$title)
clusplot(bangumi.viewfollow, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.viewfollow, labs=rownames(bangumi.viewfollow), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="follow",#
        ylab="subscriber",#
        cex = 0.5)
tyopeof(bangumi.viewfollow)
typeof(bangumi.viewfollow)
rawdata[c("view","follow")]
unlist(rawdata[c("view","follow")])
bangumi.viewfollow <- matrix(unlist(rawdata[c("view","follow")]), nrow = 200, ncol = 2)
matrix(unlist(rawdata[c("view","follow")]), nrow = 200, ncol = 2)
matrix(unlist(rawdata[c("view_calculated","follow")]), nrow = 200, ncol = 2)
matrix(unlist(rawdata[c("view_calculated","follow")]), nrow = 200, ncol = 2, dimnames=c(NULL, c("view","follow")))
matrix(unlist(rawdata[c("view_calculated","follow")]), nrow = 200, ncol = 2, dimnames=list(NULL, c("view","follow")))
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# data preprocessing#
bangumi.datasize <- 200#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# data preprocessing#
bangumi.datasize <- 200#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(NULL, c("follow","view")))
bangumi.followview
bangumi.data <- scale(bangumi.followview)
bangumi.data
bangumi.followview
bangumi.data
row.names(bangumi.data) <- rawdata$title
bangumi.data
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# data preprocessing#
bangumi.datasize <- 200#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))
bangumi.followview
bangumi.data <- scale(bangumi.followview)
bangumi.data
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}
colnames(viewdata) <- c("view1","view3","view1n","view3n")
viewdata
bangumi.data <- cbind(bangumi.data, viewdata)
bangumi.data
bangumi.dist <- dist(bangumi.data[1:50,])#
bangumi.hc <- hclust(bangumi.dist)#
number_cluster <- 7#
png(file="assets/hierarchical_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = "Hierarchical Clustering on 50 Most Popular Anime in Bilibili",#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number_cluster, border = 2:number_cluster+1)#
par(op)#
dev.off()
pllibrary(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="follow",#
        ylab="subscriber",#
        cex = 0.5)
oo <- options()#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="follow",#
        ylab="subscriber",#
        cex = 0.5)#
par(op)#
options(oo)
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
par(op)#
options(oo)#
dev.off()
plot(bangumi.followview)
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)
bangumi.data
bangumi.followview["齐木楠雄的灾难（日播&精选版）", ]
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1])#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2])#
l <- c("齐木楠雄的灾难（日播&精选版）")#
text(x,y,labels=l)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1])#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2])#
l <- c("齐木楠雄的灾难（日播&精选版）")#
text(x,y,labels=l)#
par(op)#
options(oo)
1e9
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1])#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2])#
l <- c("齐木楠雄的灾难（日播&精选版）")#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6)#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2])#
l <- c("齐木楠雄的灾难（日播&精选版）")#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=5, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6)#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2])#
l <- c("齐木楠雄的灾难（日播&精选版）")#
text(x,y,labels=l)#
par(op)#
options(oo)
bangumi.data
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1],#
        bangumi.followview["齐木楠雄的灾难",1],#
        bangumi.followview["紫罗兰永恒花园",1],#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2],#
        bangumi.followview["工作细胞",2],#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2],#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园",#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1],#
        bangumi.followview["齐木楠雄的灾难",1],#
        bangumi.followview["紫罗兰永恒花园",1]#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2],#
        bangumi.followview["工作细胞",2],#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1]-0.5e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.1e7,#
        bangumi.followview["工作细胞",2],#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.1e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1]-0.5e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.3e7,#
        bangumi.followview["工作细胞",2],#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1]-0.5e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2],#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1]-0.5e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2],#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1]-0.5e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.5e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1],#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.2e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.2e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l)#
par(op)#
options(oo)#
dev.off()
par
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.2e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.2e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8,font=2)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei', font=2)#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.2e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.5e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.2e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2],#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.7e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.5e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.7e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.5e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1.1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.5e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)#
x <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.data["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.data["工作细胞",1]-0.4e6,#
        bangumi.data["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.data["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.data["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.data["工作细胞",2]-0.4e7,#
        bangumi.data["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.data["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)#
x <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.data["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.data["工作细胞",1]-0.4e6,#
        bangumi.data["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.data["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.data["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.data["工作细胞",2]-0.4e7,#
        bangumi.data["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.data["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)#
x <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",1]+1.3,#
        bangumi.data["Re：从零开始的异世界生活",1]+1,#
        bangumi.data["工作细胞",1]-0.4,#
        bangumi.data["齐木楠雄的灾难",1]-0.6,#
        bangumi.data["紫罗兰永恒花园",1]+0.6#
        )#
y <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.data["Re：从零开始的异世界生活",2]-0.4,#
        bangumi.data["工作细胞",2]-0.4,#
        bangumi.data["齐木楠雄的灾难",2]-0.4,#
        bangumi.data["紫罗兰永恒花园",2]-0.4#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)
png(file="assets/kmeans_clustering_2.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.data, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)#
x <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",1],#
        bangumi.data["Re：从零开始的异世界生活",1],#
        bangumi.data["工作细胞",1],#
        bangumi.data["齐木楠雄的灾难",1],#
        bangumi.data["紫罗兰永恒花园",1]#
        )#
y <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.data["Re：从零开始的异世界生活",2],#
        bangumi.data["工作细胞",2],#
        bangumi.data["齐木楠雄的灾难",2],#
        bangumi.data["紫罗兰永恒花园",2]#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 3#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 3#
bangumi.kmeans <- kmeans(bangumi.data[,1:50], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 3#
bangumi.kmeans <- kmeans(bangumi.data[1:50,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 3#
bangumi.kmeans <- kmeans(bangumi.data[1:50,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
# x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
#         bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
#         bangumi.followview["工作细胞",1]-0.4e6,#
#         bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
#         bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
#         )#
# y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
#         bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
#         bangumi.followview["工作细胞",2]-0.4e7,#
#         bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
#         bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
#         )#
# l <- c("齐木楠雄的灾难（日播&精选版）",#
#         "Re：从零开始的异世界生活",#
#         "工作细胞",#
#         "齐木楠雄的灾难",#
#         "紫罗兰永恒花园"#
#         )#
# text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 3#
bangumi.kmeans <- kmeans(bangumi.data[1:50,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:50,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:50,], labs=rownames(bangumi.followview)[1:50], var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data[1:50,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:50,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:50,], labs=rownames(bangumi.followview)[1:50], var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data[1:100,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:50,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:100,], labs=rownames(bangumi.followview)[1:100], var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:50,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:50,], bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data[1:100,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:100,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:100,], labs=rownames(bangumi.followview)[1:100], var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data[1:100,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:100,], bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview[1:100,], labs=rownames(bangumi.followview)[1:100], var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难",1]-0.6e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["齐木楠雄的灾难",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering_2.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.data[1:100,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        labels=0, #
        lines=0, #
        main="K-means Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)#
x <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",1],#
        bangumi.data["Re：从零开始的异世界生活",1],#
        bangumi.data["工作细胞",1],#
        bangumi.data["齐木楠雄的灾难",1],#
        bangumi.data["紫罗兰永恒花园",1]#
        )#
y <- c(bangumi.data["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.data["Re：从零开始的异世界生活",2],#
        bangumi.data["工作细胞",2],#
        bangumi.data["齐木楠雄的灾难",2],#
        bangumi.data["紫罗兰永恒花园",2]#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
rawdata
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# data preprocessing#
bangumi.datasize <- 100#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))#
bangumi.data <- scale(bangumi.followview)#
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}#
colnames(viewdata) <- c("view1","view3","view1n","view3n") #
bangumi.data <- cbind(bangumi.data, viewdata)
# Hierarchical Clustering#
bangumi.dist <- dist(bangumi.data)#
bangumi.hc <- hclust(bangumi.dist)#
number.cluster <- 7#
png(file="assets/hierarchical_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = "Hierarchical Clustering on 50 Most Popular Anime in Bilibili",#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.cluster, border = 2:number.cluster+1)#
par(op)#
dev.off()
# Hierarchical Clustering#
bangumi.dist <- dist(bangumi.data[1:50,])#
bangumi.hc <- hclust(bangumi.dist)#
number.cluster <- 7#
png(file="assets/hierarchical_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = "Hierarchical Clustering on 50 Most Popular Anime in Bilibili",#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.cluster, border = 2:number.cluster+1)#
par(op)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data[1:100,], number.cluster, nstart=10)#
png(file="assets/kmeans_clustering_1.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:100,], bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview[1:100,], labs=rownames(bangumi.followview)[1:100], var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "齐木楠雄的灾难",#
        "紫罗兰永恒花园"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=5, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
# x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
#         bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
#         bangumi.followview["工作细胞",1]-0.4e6,#
#         bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
#         )#
# y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
#         bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
#         bangumi.followview["工作细胞",2]-0.4e7,#
#         bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
#         )#
# l <- c("齐木楠雄的灾难（日播&精选版）",#
#         "Re：从零开始的异世界生活",#
#         "工作细胞",#
#         "齐木楠雄的灾难",#
#         "紫罗兰永恒花园"#
#         )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=5, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
# x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
#         bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
#         bangumi.followview["工作细胞",1]-0.4e6,#
#         bangumi.followview["紫罗兰永恒花园",1]+0.6e6#
#         )#
# y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
#         bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
#         bangumi.followview["工作细胞",2]-0.4e7,#
#         bangumi.followview["紫罗兰永恒花园",2]-0.4e7#
#         )#
# l <- c("齐木楠雄的灾难（日播&精选版）",#
#         "Re：从零开始的异世界生活",#
#         "工作细胞",#
#         "齐木楠雄的灾难",#
#         "紫罗兰永恒花园"#
#         )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)
BANGUMI.DATA
bangumi.data
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1],#
        bangumi.followview["食戟之灵",1],#
        bangumi.followview["齐木楠雄的灾难 第二季",1]#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2],#
        bangumi.followview["食戟之灵",2],#
        bangumi.followview["齐木楠雄的灾难 第二季",2]#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.5e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+1e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.1e7,#
        bangumi.followview["食戟之灵",2]+0.1e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.1e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.3e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+1e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.1e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.8e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.2e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
op <- par(family='STXihei')#
library(cluster)#
clusplot(bangumi.pamv, #
        shade=FALSE, color=TRUE, #
        lines=0,#
        labels=0,#
        main="PAM Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        cex = 0.5)#
par(op)
pamv
bangumi.pamv
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=TRUE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub=""#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=TRUE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=TRUE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 200 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
par(op)#
options(oo)#
dev.off()
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=TRUE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 100 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# kmeans#
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()#
#
# pams#
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 100 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2],#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# kmeans#
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# kmeans#
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()#
#
# pams#
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 100 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]-0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# kmeans#
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=10)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# kmeans#
library(cluster)#
number.cluster <- 5#
bangumi.kmeans <- kmeans(bangumi.data, number.cluster, nstart=50)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        labels=0, #
        lines=0, #
        main="K-means Clustering on 100 Most Popular Anime in Bilibili",#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# pams#
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 100 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]-0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# pams#
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 100 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]-0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# pams#
library(cluster)#
number.cluster <-5#
bangumi.diss <- daisy(bangumi.data)#
bangumi.pamv <- pam(bangumi.diss, number.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview, bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview, labs=rownames(bangumi.followview), var.dec=NA),#
        lines=0,#
        labels=0,#
        main="PAM Clustering on 100 Most Popular Anime in Bilibili",#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]-0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# setting parameters#
bangumi.datasize <- 100#
number.cluster.hc <- 50#
#
# data preprocessing#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))#
bangumi.data <- scale(bangumi.followview)#
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}#
colnames(viewdata) <- c("view1","view3","view1n","view3n") #
bangumi.data <- cbind(bangumi.data, viewdata)
# Hierarchical Clustering#
bangumi.dist <- dist(bangumi.data[1:number.cluster.hc,])#
bangumi.hc <- hclust(bangumi.dist)#
number.cluster <- 7#
png(file="assets/hierarchical_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.cluster.hc, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.cluster, border = 2:number.cluster+1)#
par(op)#
dev.off()
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# setting parameters#
bangumi.datasize <- 100#
number.cluster.datasize <- 50#
number.cluster.hc <- 7#
#
# data preprocessing#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))#
bangumi.data <- scale(bangumi.followview)#
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}#
colnames(viewdata) <- c("view1","view3","view1n","view3n") #
bangumi.data <- cbind(bangumi.data, viewdata)
# Hierarchical Clustering#
bangumi.dist <- dist(bangumi.data[1:number.cluster.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.cluster.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.cluster.hc, border = 2:number.cluster.hc+1)#
par(op)#
dev.off()
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# setting parameters#
bangumi.datasize <- 100#
number.hc.datasize <- 50#
number.hc.cluster <- 7#
number.datasize.kmeans <- 100#
number.cluster.kmeans <- 5#
#
# data preprocessing#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))#
bangumi.data <- scale(bangumi.followview)#
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}#
colnames(viewdata) <- c("view1","view3","view1n","view3n") #
bangumi.data <- cbind(bangumi.data, viewdata)#
#
# Hierarchical Clustering#
bangumi.dist <- dist(bangumi.data[1:number.hc.cluster,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
rm(list=ls())
library(DBI)#
library(RMySQL)#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# setting parameters#
bangumi.datasize <- 100#
number.hc.datasize <- 50#
number.hc.cluster <- 7#
number.datasize.kmeans <- 100#
number.cluster.kmeans <- 5#
#
# data preprocessing#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))#
bangumi.data <- scale(bangumi.followview)#
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}#
colnames(viewdata) <- c("view1","view3","view1n","view3n") #
bangumi.data <- cbind(bangumi.data, viewdata)
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
rm(list=ls())
# load liabrary#
library(DBI)#
library(RMySQL)#
library(cluster)#
#
# connect to database#
Sys.setlocale(locale="UTF-8")#
con <- dbConnect(MySQL(), host="localhost", dbname="bilibili", user="root", password="57575207")#
#
# setting parameters#
bangumi.datasize <- 100#
number.hc.datasize <- 50#
number.hc.cluster <- 7#
number.kmeans.datasize <- 100#
number.kmeans.cluster <- 5#
number.pam.datasize <- 100#
number.pam.cluster <- 5#
#
# data preprocessing#
rawdata <- dbGetQuery(con, paste("SELECT * FROM bangumi WHERE ABS(view-view_calculated) < view*0.1 AND epno>10 ORDER BY view DESC LIMIT", bangumi.datasize))#
bangumi.followview <- matrix(unlist(rawdata[c("follow","view_calculated")]), #
                            nrow=bangumi.datasize, #
                            ncol=2,#
                            dimnames=list(rawdata$title, c("follow","view")))#
bangumi.data <- scale(bangumi.followview)#
viewdata <- NULL  #
for(sid in rawdata$sid){#
    sqlstr <- paste("SELECT view FROM episode WHERE sid =", sid, "ORDER BY idx")#
    epdata <- dbGetQuery(con, sqlstr)#
    epdata <- epdata$view#
    epdata <- scale(epdata)#
    len <- length(epdata)#
    row <- c(epdata[1],epdata[3],epdata[len],epdata[len-3])#
    viewdata <- rbind(viewdata, row)#
}#
colnames(viewdata) <- c("view1","view3","view1n","view3n") #
bangumi.data <- cbind(bangumi.data, viewdata)
# Hierarchical Clustering#
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE,#
    )#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.kmeans <- kmeans(bangumi.data[1:number.kmeans.datasize,], number.kmeans.cluster, nstart=50)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:number.kmeans.datasize,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:number.kmeans.datasize,], labs=rownames(bangumi.followview)[1:number.kmeans.datasize], var.dec=NA),#
        labels=0, #
        lines=0, #
        main=paste("Hierarchical Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
bangumi.kmeans <- kmeans(bangumi.data[1:number.kmeans.datasize,], number.kmeans.cluster, nstart=50)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:number.kmeans.datasize,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:number.kmeans.datasize,], labs=rownames(bangumi.followview)[1:number.kmeans.datasize], var.dec=NA),#
        labels=0, #
        lines=0, #
        main=paste("Hierarchical Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
bangumi.kmeans <- kmeans(bangumi.data[1:number.kmeans.datasize,], number.kmeans.cluster, nstart=50)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:number.kmeans.datasize,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:number.kmeans.datasize,], labs=rownames(bangumi.followview)[1:number.kmeans.datasize], var.dec=NA),#
        labels=0, #
        lines=0, #
        main=paste("Hierarchical Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# pams#
bangumi.diss <- daisy(bangumi.data[1:number.pam.datasize,])#
bangumi.pamv <- pam(bangumi.diss, number.pam.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:number.pam.datasize,], bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview[1:number.pam.datasize,], labs=rownames(bangumi.followview)[1:number.pam.datasize], var.dec=NA),#
        lines=0,#
        labels=0,#
        main=paste("Hierarchical Clustering on", number.pam.datasize, "Most Popular Anime in Bilibili"),#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]-0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# kmeans#
bangumi.kmeans <- kmeans(bangumi.data[1:number.kmeans.datasize,], number.kmeans.cluster, nstart=50)#
png(file="assets/kmeans_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:number.kmeans.datasize,], bangumi.kmeans$cluster, #
        color=TRUE, shade=FALSE, #
        s.x.2d = list(x=bangumi.followview[1:number.kmeans.datasize,], labs=rownames(bangumi.followview)[1:number.kmeans.datasize], var.dec=NA),#
        labels=0, #
        lines=0, #
        main=paste("Kmeans Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
        sub="",#
        col.txt="black",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]+0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
# pams#
bangumi.diss <- daisy(bangumi.data[1:number.pam.datasize,])#
bangumi.pamv <- pam(bangumi.diss, number.pam.cluster, diss = TRUE)#
png(file="assets/pam_clustering.png",width=3000, height=3000, res=600, pointsize=9)#
op <- par(family='STXihei')#
oo <- options(scipen=10)#
clusplot(bangumi.followview[1:number.pam.datasize,], bangumi.pamv$clustering, #
        shade=FALSE, color=TRUE, #
        s.x.2d = list(x=bangumi.followview[1:number.pam.datasize,], labs=rownames(bangumi.followview)[1:number.pam.datasize], var.dec=NA),#
        lines=0,#
        labels=0,#
        main=paste("PAM Clustering on", number.pam.datasize, "Most Popular Anime in Bilibili"),#
        col.txt="black",#
        sub="",#
        xlab="Subscriber",#
        ylab="View",#
        cex = 0.5)#
x <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",1]+1.3e6,#
        bangumi.followview["Re：从零开始的异世界生活",1]+1e6,#
        bangumi.followview["工作细胞",1]-0.4e6,#
        bangumi.followview["紫罗兰永恒花园",1]+0.6e6,#
        bangumi.followview["OVERLORD",1]-0.5e6,#
        bangumi.followview["食戟之灵",1]-0.4e6,#
        bangumi.followview["齐木楠雄的灾难 第二季",1]+0.9e6#
        )#
y <- c(bangumi.followview["齐木楠雄的灾难（日播&精选版）",2]-0.2e7,#
        bangumi.followview["Re：从零开始的异世界生活",2]-0.4e7,#
        bangumi.followview["工作细胞",2]-0.4e7,#
        bangumi.followview["紫罗兰永恒花园",2]-0.4e7,#
        bangumi.followview["OVERLORD",2]+0.3e7,#
        bangumi.followview["食戟之灵",2]+0.3e7,#
        bangumi.followview["齐木楠雄的灾难 第二季",2]-0.3e7#
        )#
l <- c("齐木楠雄的灾难（日播&精选版）",#
        "Re：从零开始的异世界生活",#
        "工作细胞",#
        "紫罗兰永恒花园",#
        "OVERLORD",#
        "食戟之灵",#
        "齐木楠雄的灾难 第二季"#
        )#
text(x,y,labels=l,cex=0.8)#
par(op)#
options(oo)#
dev.off()
clussi.pam <- silhouette(bangumi.pamv)#
plot(si.pam)
si.pam <- silhouette(bangumi.pamv)#
plot(si.pam)
si.kmeans <- silhouette(bangumi.kmeans)#
plot(si.kmeans)
mbangumi.kmeans
bangumi.kmeans
bangumi.pamv
silhouette(bangumi.kmeans)
bangumi.kmeans
si.kmeans <- silhouette(bangumi.kmeans$cluster)#
plot(si.kmeans)
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)
plot(si.kmeans)
plot(kmeans.si)
si.pam <- silhouette(bangumi.pamv)#
plot(si.pam)
plot(kmeans.si#
    col=1:number.kmeans.cluster,#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    do.col.sort=true#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    do.col.sort=TRUE#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    do.col.sort=TRUE#
    )
ls()
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    do.col.sort=TRUE#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    do.col.sort=TRUE,#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    )
plot(kmeans.si,#
    col=1:number.kmeans.cluster,#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    # col=1:number.kmeans.cluster,#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=rainbow(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=heat.color(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=heat.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=topo.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=cm.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=TRUE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    border = par("fg"),#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=TRUE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )
op <- par(cex.lab=0.3)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
par(op)
op <- par(cex=0.5)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
par(op)
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600, pointsize=9)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
par(bg)
par(fg)
getpar()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main="Silhouette Plot",#
    sub=paste("Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"))#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main="Silhouette Plot",#
    sub=paste("Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili")),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main="Silhouette Plot",#
    sub=paste("Kmeans on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main="Silhouette Plot of Kmeans",#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=10#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=100#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    space=0#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=3000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=5000, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=3000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=4500, height=3000, res=600)#
plot(kmeans.si,#
    col=heat.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=4500, height=3000, res=600)#
plot(kmeans.si,#
    col=ranbow(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=4500, height=3000, res=600)#
plot(kmeans.si,#
    col=rainbow(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=4000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=6000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=FALSE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=6000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=7000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=800)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=6000, height=6000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=6000, height=6000, res=600)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=6000, height=6000, res=600)#
op <- par()#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png")#
op <- par()#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png")#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7,font.lab=2)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
bangumi.dist <- dist(bangumi.data[1:number.hc.datasize,])#
bangumi.hc <- hclust(bangumi.dist)#
png(file="assets/hierarchical_clustering.png", width=3000, height=3000, res=600, pointsize=9)#
op <- par(mai=c(0.1,0.7,0.1,0.1),lwd=0.7)#
plot(bangumi.hc, #
    hang = -1, #
    cex = .5, #
    ylab = paste("Hierarchical Clustering on", number.hc.datasize, "Most Popular Anime in Bilibili"),#
    family='STXihei',#
    xlab="",#
    main="",#
    sub="",#
    axes=TRUE)#
cluster.result <- rect.hclust(bangumi.hc, k=number.hc.cluster, border = 2:number.hc.cluster+1)#
par(op)#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4000, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=5000, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
pam.si <- silhouette(bangumi.pamv)#
png(file="assets/pam_silhouette.png",width=4500, height=8000, res=600)#
plot(pan.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of PAM", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
pam.si <- silhouette(bangumi.pamv)#
png(file="assets/pam_silhouette.png",width=4500, height=8000, res=600)#
plot(pam.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of PAM", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    width=1000#
    )#
dev.off()
Silhouette Plotkmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    nmax.lab=100#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    nmax.lab=100#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    nmax.lab=1000#
    )#
dev.off()
kmeans.dist
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    xlab = expression("Silhouette width "* s[i])#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- sortSilhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    sub = expression("Silhouette width "* s[i])#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=4500, height=8000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=5500, height=10000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=5000, height=90000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
kmeans.dist <- dist(bangumi.data[1:number.kmeans.datasize,])#
kmeans.si <- silhouette(bangumi.kmeans$cluster, dist=kmeans.dist)#
png(file="assets/kmeans_silhouette.png",width=5000, height=9000, res=600)#
plot(kmeans.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of Kmeans Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
pam.si <- silhouette(bangumi.pamv)#
png(file="assets/pam_silhouette.png",width=5000, height=9000, res=600)#
plot(pam.si,#
    col=terrain.colors(number.kmeans.datasize),#
    main=paste("Silhouette Plot of PAM Clustering on", number.kmeans.datasize, "Most Popular Anime in Bilibili"),#
    do.clus.stat=TRUE,#
    do.col.sort=FALSE,#
    do.n.k=FALSE,#
    )#
dev.off()
